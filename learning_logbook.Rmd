---
title: "Learning logbook on Tree phenology analysis with R"
author: "Clemens Stephany"
date: "10/11/2021"
output: html_document
bibliography: "bib/Tree Phenology.bib"
link-citations: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

[Course Materials](http://inresgb-lehre.iaas.uni-bonn.de/chillR_book/winter-chill-projections.html)

## Tree Dormancy (Chapter 3)
Exercises on tree dormancy

1. Put yourself in the place of a breeder who wants to calculate the temperature requirements of a newly released cultivar. Which method will you use to calculate the chilling and forcing periods? Please justify your answer.<p><p>
As temperature requirements are dependent on the cultivar, new data about the date of dormancy has to be collected with an experimental approach first. If this data was already collected by an institute one can calculate the chilling and forcing period by using weather data and statistical methods such as a partial least square (PLS) regression analysis [@luedeling_identification_2013]. With this method the chilling phase can be calculated using the dynamic model and the forcing phase is calculated using growing degree dates (GDD). Knowing in which specific timespan chilling and heat is especially important for a cultivar a fitting one can be selected for the region. Site-specific knowledge is also essential to pick future-proof cultivars that are already adapted for global warming.<p>

2. Which are the advantages (2) of the BBCH scale compared with earlies scales? <p>
   * Standardizes the phenological stages and make them easily recognizable under all field conditions across species to have an easily comparable metric for classification.
   * Two digit code allows two orders of scale, where the macro stage (principal growth stages) is represented by the first digit and describes time spans and the second digit specifies micro stages (secondary growth stages) precise steps within.
<p>

3. Classify the following phenological stages of sweet cherry according to the BBCH scale:
![BBCH_states_cherry](http://inresgb-lehre.iaas.uni-bonn.de/chillR_book/pictures/pheno_stages.png)
Left image: 56 - Flower pedicel elongating (in the top most bud sepals can be seen as a white tip)<br>
Middle image: 61 to 65 - Flowering (all flowers to be seen are open, but to determine the correct percentage a broader view is needed)<br>
Right image: 89 - Fruit ripe for harvesting<br>
(See @fadon_flower_2015 for reference)
<p>

## Climate change and impact projection (Chapter 4)
Exercises on climate change<p>

1. List the main drivers of climate change at the decade to century scale, and briefly explain the mechanism through which the currently most important driver affects our climate. <p><p>
   * Sun: Variation in radiation over time.
   * Aerosols: Various molecules or particles suspended in the air. Can block radiation and can thus affect local climate massively (e.g. smog). Both natural and anthropogenic sources exists.
   * Clouds: Blocks radiation in both directions, so incoming radiation is partially kept out and reflected radiation from earth gets trapped.
   * Ozone: Ozone blocks harmful UV-A radiation but also acts as a greenhouse gas. Destroying the natural ozone shield heightened risk of skin cancer and cause(d) environmental damage.
   * Surface albedo: Surfaces reflect/absorb radiation dependent on their material.
   Greenhouse gases (GHGs): Absorb radiation at certain wavelengths (Long-wave radiation from the earth surface). Major GHGs are water vapour, carbon dioxide (CO~2~), methane (CH~4~) and nitrous oxide (N~2~O). By far the biggest driver of the recent climate change.<p>
2. Explain briefly what is special about temperature dynamics of the recent decades, and why we have good reasons to be concerned.<p><p>
Considering the two last millenniums up to a few decades ago the global climate was quite cold on average. Looking at the last decade the the average temperature keeps rising above every record previously know. The Problem with the increasing temperatures are not only direct effects, but positive feedback such as melting ice caps or defrosting permafrost landscapes. With increasing temperature the surface albedo changes and will absorb even more radiation or frozen methane is being released which will increase the warming even more. While such periods exist in earth history already, they were spread across million years. This time gave enough time for evolution to adapt and move across the planet. What usually happens on such a large temporal scale is now happening within a decade with no time for such adaptation.
3. What does the abbreviation ‘RCP’ stand for, how are RCPs defined, and what is their role in projecting future climates? <p><p>
The Representative Concentration Pathways (RCPs) are possible climate scenarios simulating the impact of different GHG emission pathways from 2000 to 2100. The number after RCP (e.g. RCP6.0) stands for the additional expected radiative forcing (W m^-2^) by 2100. They are large scale simulations from which other studies derive their data to calculate global climate models and with some model based downscaling (shouldn't it be upscaling?) regional climate models.
4. Briefly describe the 4 climate impact projection methods described in the fourth video. <p>
   * Statistical models: Establish a relationship between different climatic parameters and ecological data which is then used to project future distributions. Because of the wide range of results using different algorithms using an ensemble has become common. But there are also other limitations. The statistical relationship doesn't have to remain valid due to e.g. other factors changing that weren't included in the original model. It is also assuming that the species distribution is in an equilibrium with the climate, which may change or is already not the case as humans plant what they need, not what is naturally best suited.
   * Process-based models: Represents all major systems processes with equations based on the best scientific knowledge on each of the subjects. They are very precise but highly specific, which results in extensive assumptions and/or extensive parametrization. Even seemingly small processes are often not sufficiently understood and such models for large and complex systems don't even exists. There are also often linear assumptions build into these process models, which might not be valid in the future.
   * Climate analogue models: Projected climate at a given location might already exists today somewhere else with similar climate conditions. While the general idea sounds promising, there are a lot of other aspects being more important than the difference in climate itself. If differences are to be found, there is also the question of origin. Are these differences due to climate or other factors? The work to balance out all these different factors to make the sides comparable starts to not make this kind of approach feasible anymore.<p>
   <br>Here is an extensive overview of these three methods:
![climate_impact_projections_methods_workflow](https://ars.els-cdn.com/content/image/1-s2.0-S1877343513000924-gr1.jpg)
![climate_impact_projections_methods_pro_con](https://ars.els-cdn.com/content/image/1-s2.0-S1877343513000924-gr2.jpg) <br>
Source: @luedeling_agroforestry_2014 <p>
   * Complex systems: The approach to model complex system is a holistic one incorporating any relevant information from all kind of resources. Handling uncertainties very well, it allows rough estimates to be inputs of the model and can thus cover all relevant aspects without extensive studies. The core are causal models which combine the information to calculate an outcome distribution. This approach is used in Decision Science and can be seen in this [project](https://github.com/cemno/optimizing-pesticide-application-in-orchards) from last semester.

## Winter chill projections (Chapter 5)
Exercises on past chill projections<p>
1. Sketch out three data access and processing challenges that had to be overcome in order to produce chill projections with state-of-the-art methodology. <p><p>
   * Getting regional high resolution temperature data (Oman): To calculate chilling hours per day high resolution temperature data is needed. But as the temperature sensors where only being set up since a few years, high resolution data for several years was missing. This problem was overcome by a luckily nearby airport which generously donated its data.
   * Processing global data into high-resolution regional data (Tunisia): To calculate suitable data for a regional study you have to use rasterized data from the GCMs and upscale them using a regional climate model. But considering an ensemble study is required, as usually the case, this scales processing and data storage requirements exponentially. This further imposes problems if no automated way of processing the data is set up.
   * Processing data without programming language, usable models or an API (up to California):
   Up to now a lot of data was analysed manually with excel or filling creating data with models. This took a lot of time and was cumbersome. Different programms where used all requiring different input methods. This was later solved with an programming language.
   * Processing multiple scenarios increases processing and storage requirements exponentially (Kenya)
<p>
2. Outline, in your understanding, the basic steps that are necessary to make such projections.<p><p>
test

## Manual chill analysis (Chapter 6)
Exercises on basic chill modelling
1. Write a basic function that calculates warm hours (>25°C)
2. Apply this function to the Winters_hours_gaps dataset
3. Extend this function, so that it can take start and end dates as inputs and sums up warm hours between these dates

To evaluate the performance of different methods all these exercises where combined and extended in the following script.

```{r exercise_6, cache=TRUE, code=readLines("exercise_6.R")}
```

## Chill Models (Chapter 7)
Exercises on chill models<p>
1. Run the chilling() function on the Winters_hours_gap dataset
2. Create your own temperature-weighting chill model using the step_model() function
3. Run this model on the Winters_hours_gaps dataset using the tempResponse() function.

```{r exercise_7, cache=TRUE, code=readLines("exercise_7.R")}
```

# Bibliography

